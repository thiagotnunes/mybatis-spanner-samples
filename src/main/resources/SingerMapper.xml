<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SingerMapper">
  <resultMap id="albumResultMap" type="Album">
    <id property="SingerId" column="SingerId" />
    <id property="AlbumId" column="AlbumId" />
    <result column="AlbumTitle" property="AlbumTitle" />
  </resultMap>
  <resultMap id="singerResultMap" type="Singer">
    <id property="SingerId" column="SingerId" />
    <result property="FirstName" column="FirstName" />
    <result property="LastName" column="LastName" />
    <collection property="Albums" column="SingerId" ofType="Album" select="selectAlbumsForSinger" />
  </resultMap>

  <select id="selectSingers" resultType="Singer">
    SELECT SingerId, FirstName, LastName FROM Singers WHERE TRUE
  </select>

  <select id="selectAlbumsForSinger" resultMap="albumResultMap">
    SELECT SingerId, AlbumId, AlbumTitle
    FROM Albums
    WHERE SingerId = #{SingerId}
  </select>
  <select id="nestedSelectSingersAndAlbums" resultMap="singerResultMap">
    SELECT SingerId, FirstName, LastName
    FROM Singers
    WHERE TRUE
  </select>

  <insert id="insertSinger" parameterType="Singer">
    INSERT INTO Singers (SingerId, FirstName, LastName) VALUES (#{SingerId}, #{FirstName}, #{LastName})
  </insert>
</mapper>
